### Keep Your Fedora Laptop Running with the Lid Closed

By default, Fedora suspends your laptop when you close the lid to save power. To change this behavior—for instance, to keep music playing or downloads running—you should create a systemd configuration override.

**Do not edit `/usr/lib/systemd/logind.conf`.**

Instead, follow these steps:

1.  **Create a configuration file.**:

    ```bash
    sudo mkdir -p /etc/systemd/logind.conf.d/
    sudo vi /etc/systemd/logind.conf.d/lid.conf
    ```

2.  **Add your desired settings.** Paste the following into the file. You only need to specify the settings you wish to change.

    ```ini
    # This keeps the system running with the lid closed
    # when plugged into AC power, but suspends on battery.
    [Login]
    HandleLidSwitchExternalPower=lock
    HandleLidSwitch=suspend
    ```

      * `ignore`: Keeps the system running (screen off).
      * `suspend`: Puts the system to sleep.
      * `lock`: Locks the screen but keeps the system running.

3.  **Save the file and apply changes.**:

    ```bash
    sudo systemctl restart systemd-logind.service
    ```

Your new lid settings are now active.


### \#\# Manual: Fixing Linux Laptops That Fail to Wake From Suspend

This guide covers how to diagnose and fix an issue where a laptop fails to resume from suspend, resulting in a black screen or a system crash (indicated by a flashing Caps Lock light).

\<hr\>

### \#\#\# 1. The Problem

The system enters suspend (sleep) mode correctly, but when you try to wake it, one or more of the following occurs:

  * The screen(s) remain black.
  * The keyboard backlight and fans turn on, but the system is unresponsive.
  * The Caps Lock light flashes, indicating a kernel panic or firmware error.
  * A hard shutdown (holding the power button) is required to recover.

This is often caused by a specific hardware device failing to resume from its low-power state, which destabilizes the entire system.

\<hr\>

### \#\#\# 2. The Debug Method

The goal is to find the specific device that is failing.

1.  **Check Logs from the Previous Crash:** After forcing a reboot, check the system journal from the failed session. This is the most important step.

    ```bash
    journalctl --boot=-1
    ```

    Look near the end of the log for kernel messages containing `failed`, `error`, or `suspend`. The most critical clue is a line like this:
    `kernel: usb 3-9.1: Failed to suspend device, error -71`

2.  **Identify the Faulty Device:** The error message identifies the bus the device is on (e.g., `Bus 003`). Use the `lsusb` command to list all devices on that bus and find the culprit.

    ```bash
    lsusb
    ```

    From the list, identify the **Vendor and Product ID** of the suspect device (e.g., `ID 8087:0026` for an Intel Bluetooth adapter).

\<hr\>

### \#\#\# 3. The Solution

The most reliable solution is to create a `udev` rule that tells the kernel's power manager to ignore that specific device, preventing it from entering the faulty sleep state.

1.  **Create a `udev` Rule File:**

    ```bash
    sudo nano /etc/udev/rules.d/99-bad-device-power-fix.rules
    ```

2.  **Add the Rule:** Add the following line, replacing the Vendor (`8087`) and Product (`0026`) IDs with the ones you found.

    ```
    ACTION=="add", SUBSYSTEM=="usb", ATTRS{idVendor}=="8087", ATTRS{idProduct}=="0026", TEST=="power/control", ATTR{power/control}="on"
    ```

3.  **Apply and Reboot:**

    ```bash
    sudo udevadm control --reload-rules
    sudo reboot
    ```

This precisely targets and resolves the root cause without affecting the power management of other devices.

\<hr\>

### \#\#\# 4. Other Potential Fixes

If the logs do not point to a specific USB device, these are other common solutions:

  * **Update Firmware:** `sudo fwupd refresh && sudo fwupd update`
  * **Disable Graphics Features:** Add kernel parameters like `i915.enable_fbc=0`.
  * **Change Suspend Mode:** Add the kernel parameter `mem_sleep_default=s2idle`.